<script>
(async function () {
  const grid = document.getElementById('blogGrid');
  if (!grid) return;

  const fixedCards = `
    <a href="https://amzn.to/3IU7swe" target="_blank" rel="noopener noreferrer"
       class="group rounded-2xl border border-slate-200 bg-white overflow-hidden hover:shadow-xl transition-shadow duration-300 block">
      <div class="relative">
        <img loading="lazy"
             src="https://images.unsplash.com/photo-1524995997946-a1c2e315a42f?q=80&w=1600&auto=format&fit=crop"
             alt="Top 10 Livros de Saúde Natural da Amazon em 2025"
             class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-500">
        <span class="absolute left-3 top-3 bg-slate-900 text-white text-xs font-bold rounded-full px-2 py-1">
          Livros
        </span>
      </div>
      <div class="p-6">
        <h4 class="text-xl font-semibold tracking-tight text-slate-900 group-hover:text-emerald-700">
          Top 10 Livros de Saúde Natural da Amazon em 2025
        </h4>
        <p class="mt-2 text-slate-600">
          Nossa curadoria com os títulos mais bem avaliados para transformar sua rotina.
        </p>
      </div>
    </a>

    <a href="guia.html"
       class="group rounded-2xl border border-slate-200 bg-white overflow-hidden hover:shadow-xl transition-shadow duration-300 block">
      <div class="relative">
        <img loading="lazy"
             src="img/planta2.png"
             alt="Guia Completo de Suplementos Naturais"
             class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-500"
             onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1607619056574-7b8d3ee536b2?q=80&w=1600&auto=format&fit=crop';">
        <span class="absolute left-3 top-3 bg-emerald-700 text-white text-xs font-bold rounded-full px-2 py-1">
          Guia
        </span>
      </div>
      <div class="p-6">
        <h4 class="text-xl font-semibold tracking-tight text-slate-900 group-hover:text-emerald-700">
          Guia Completo de Suplementos Naturais
        </h4>
        <p class="mt-2 text-slate-600">
          Entenda os benefícios, doses seguras e como escolher os melhores produtos.
        </p>
      </div>
    </a>
  `;

  const cardArticle = (a) => {
    const title = a.title || "Artigo";
    const img = a.image || "https://images.unsplash.com/photo-1512621776951-a57141f2eefd?q=80&w=1600&auto=format&fit=crop";
    const tag = a.pillar || a.category || "Conteúdo";
    const desc = (a.excerpt || a.description || "").toString();

    return `
      <a href="artigos/${a.slug}.html"
         class="group rounded-2xl border border-slate-200 bg-white overflow-hidden hover:shadow-xl transition-shadow duration-300 block">
        <div class="relative">
          <img loading="lazy"
               src="${img}"
               alt="${title}"
               class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-500"
               onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1524995997946-a1c2e315a42f?q=80&w=1600&auto=format&fit=crop';">
          <span class="absolute left-3 top-3 bg-emerald-600 text-white text-xs font-bold rounded-full px-2 py-1">
            ${tag}
          </span>
        </div>
        <div class="p-6">
          <h4 class="text-xl font-semibold tracking-tight text-slate-900 group-hover:text-emerald-700">
            ${title}
          </h4>
          <p class="mt-2 text-slate-600">
            ${desc.slice(0, 120)}
          </p>
          <div class="mt-4 inline-flex items-center text-emerald-700 font-semibold">
            Ler agora →
          </div>
        </div>
      </a>
    `;
  };

  // Sempre começa limpo
  grid.innerHTML = "";

  try {
    // Use caminho ABSOLUTO pra evitar bug de caminho relativo
    const res = await fetch("/artigos/articles.json", { cache: "no-store" });

    if (!res.ok) throw new Error("articles.json HTTP " + res.status);

    const articles = await res.json();
    const list = Array.isArray(articles) ? articles : [];

    const top = list.slice(0, 3);
    grid.innerHTML = top.map(cardArticle).join("");
  } catch (e) {
    // Se der qualquer erro, NÃO quebra o blog: só segue com os fixos
    console.warn("Falha ao carregar /artigos/articles.json:", e);
  } finally {
    // GARANTIA: os 2 cards antigos SEMPRE aparecem
    grid.insertAdjacentHTML("beforeend", fixedCards);
  }
})();
</script>
